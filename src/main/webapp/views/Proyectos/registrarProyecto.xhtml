<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:poue="http://primefaces.org/ui/extensions">

    <ui:composition template="/WEB-INF/templates/layout.xhtml">
        <ui:define name="content">
            <p:outputLabel value="Registro de Proyectos Internacionales" id="titulo" style="display:block; text-align:center"/>
            <h:form id="formAdmin">
                <center> 
                    <p:panel style="width: 80%">  
                        <p:accordionPanel multiple="true" activeIndex="0,1,2,3" id="acordion">
                            <p:tab title="Datos del Proyecto">
                                <p:panelGrid>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Tipo de Proyecto:" />
                                        </p:column>
                                        <p:column >
                                            <p:selectOneMenu id="tipoproyecto" value="#{proyectosMB.proyectoSelected.idTipoProyecto}" style="width:180px" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <c:forEach var="reg" items="#{proyectosMB.tipoproyectolist}">
                                                    <f:selectItem itemLabel="#{reg.nombreTipoProyecto}" itemValue="#{reg.idTipoProyecto}"/>
                                                </c:forEach>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Nombre de convenio:" />
                                        </p:column>
                                        <p:column>
                                            <h:outputLink id="fade" value="#">
                                                <p:selectOneMenu id="propuesta" value="#{proyectosMB.propuestaConvenioSelected.idPropuesta}" style="width:180px">
                                                    <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                    <c:forEach var="propuesta" items="#{proyectosMB.propuestaConvenioList}">
                                                        <f:selectItem itemLabel="#{propuesta.nombrePropuesta}" itemValue="#{propuesta.idPropuesta}" />
                                                    </c:forEach>
                                                </p:selectOneMenu>
                                            </h:outputLink>
                                            <p:tooltip id="toolTipFade" for="fade" value="Este campo es unicamente para proyectos que se relacionen a un convenio"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Facultad/Unidad:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="facultadproyecto" value="#{proyectosMB.facultadSelectedPojoP}" style="width:180px" required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <p:ajax listener="#{proyectosMB.onFacultadChange()}"  process="@this"/>
                                                <c:forEach var="fac" items="#{proyectosMB.facultadesUnidadesList}">
                                                    <f:selectItem itemLabel="#{fac.label}" itemValue="#{fac.value}"/>
                                                </c:forEach>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Monto del Proyecto:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText value="#{proyectosMB.proyecto.montoProyecto}"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel  value="A&ntilde;o de Gesti&oacute;n: " />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="desde" value="#{proyectosMB.anio}" style="width:180px" required="true">
                                                <c:forEach begin="0" end="125" varStatus="loop">
                                                    <c:set var="currentYear" value="${proyectosMB.yearActual-loop.index} " />
                                                    <f:selectItem itemValue="#{currentYear}" itemLabel="#{currentYear}"/>
                                                </c:forEach>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Lugar de Ejecuci&oacute;n:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText value="#{proyectosMB.proyecto.lugarProyecto}"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column >
                                            <p:outputLabel value="Nombre del Proyecto:"  />
                                        </p:column>
                                        <p:column>
                                            <p:inputTextarea value="#{proyectosMB.proyecto.nombreProyecto}"  rows="2" maxlength="300" style="width:180px"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Objetivo del Proyecto:" />
                                        </p:column>
                                        <p:column>
                                            <p:inputTextarea value="#{proyectosMB.proyecto.objetivo}" rows="2" maxlength="1000" style="width:180px"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Fecha Inicio:"/>
                                        </p:column>
                                        <p:column>
                                            <p:calendar id="fechainicio" pattern="dd/MM/yyyy"  navigator="true" yearRange="c-50:c+10" value="#{proyectosMB.proyecto.fechaInicio}" />
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Fecha Finalizaci&oacute;n:"/>
                                        </p:column>
                                        <p:column>
                                            <p:calendar id="fechafin" pattern="dd/MM/yyyy" navigator="true" yearRange="c-50:c+10" value="#{proyectosMB.proyecto.fechaFin}">

                                            </p:calendar>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Pais cooperante:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="paiscooperante" value="#{proyectosMB.paisCooperanteSelected.idPais}" style="width:180px">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" />
                                                <c:forEach var="pais" items="#{proyectosMB.paisCooperanteList}">
                                                    <f:selectItem itemLabel="#{pais.nombrePais}" itemValue="#{pais.idPais}"/>
                                                </c:forEach>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Organismos cooperantes:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectCheckboxMenu id="organismoproy" value="#{proyectosMB.organismoProySelected}" label="Seleccione"
                                                                  filter="true" filterMatchMode="startsWith" panelStyle="width:250px" style="width: 180px">
                                                <c:forEach var="org" items="#{proyectosMB.organismoProyList}">
                                                    <f:selectItem itemLabel="#{org.nombreOrganismo}" itemValue="#{org.idOrganismo}"/>
                                                </c:forEach>
                                            </p:selectCheckboxMenu>
                                        </p:column>

                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Area de Conocimiento:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectCheckboxMenu id="areaconocimiento" value="#{proyectosMB.areaConocimientoSelected}" label="Seleccione"
                                                                  filter="true" filterMatchMode="startsWith" panelStyle="width:250px" style="width: 180px">
                                                <c:forEach var="reg" items="#{proyectosMB.areaConocimientoList}">
                                                    <f:selectItem itemLabel="#{reg.nombreArea}" itemValue="#{reg.idAreaConocimiento}"/>
                                                </c:forEach>
                                            </p:selectCheckboxMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Facultad Beneficiada:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectCheckboxMenu id="facultadbeneficiada" value="#{proyectosMB.facultadBeneficiadaSelected}" label="Seleccione"
                                                                  filter="true" filterMatchMode="startsWith" panelStyle="width:250px" style="width: 180px">
                                                <c:forEach var="fac" items="#{proyectosMB.facultadBeneficiadaList}">
                                                    <f:selectItem itemLabel="#{fac.nombreFacultad}" itemValue="#{fac.idFacultad}"/>
                                                </c:forEach>
                                            </p:selectCheckboxMenu>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>
                            </p:tab>
                            <p:tab title="Datos del Coordinador del proyecto">
                                <p:panelGrid>
                                    <p:column>
                                        <p:outputLabel value="Dui:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputMask id="duisol" mask="99999999-9" value="#{proyectosMB.numDocumentoSol}"/>
                                        <p:commandButton actionListener="#{proyectosMB.searchByDocInterno(proyectosMB.numDocumentoSol)}" id="idBtnSearchInSol" process="@this,duisol" update="duisolicitante,correosolicitante,nombresolicitante,apellidosolicitante,cargosolicitante,facultadsolicitante,unidadsolicitante,telefonosolicitante,celularsolicitante" icon="ui-icon-search" value="Buscar"/>
                                    </p:column>
                                </p:panelGrid>
                                <p:separator/>
                                <p:panelGrid columns="4">
                                    <p:column>
                                        <p:outputLabel value="Nombre:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="nombresolicitante" value="#{proyectosMB.persona.nombrePersona}" />
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Apellido:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="apellidosolicitante" value="#{proyectosMB.persona.apellidoPersona}" />
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Dui:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputMask id="duisolicitante" mask="99999999-9" value="#{proyectosMB.persona.duiPersona}" required="true"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Correo Electr&oacute;nico:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="correosolicitante" value="#{proyectosMB.persona.emailPersona}"/>                                       
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Cargo:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="cargosolicitante" value="#{proyectosMB.persona.cargoPersona}"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Facultad/Unidad:"/>
                                    </p:column>
                                    <p:column>
                                        <p:selectOneMenu id="facultadsolicitante" value="#{proyectosMB.facultadSelectedPojoSol}"  style="width:180px" required="true">
                                            <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                            <c:forEach var="facu" items="#{proyectosMB.facultadesUnidadesList}">
                                                <f:selectItem itemLabel="#{facu.label}" itemValue="#{facu.value}"/>
                                            </c:forEach>
                                            <p:ajax event="change" listener="#{proyectosMB.mostrarCampo()}" update="unidadsolicitante" process="@this" partialSubmit="true"/>
                                        </p:selectOneMenu>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Escuela/Departamento:"/>
                                    </p:column>
                                    <p:column>
                                        <p:selectOneMenu id="unidadsolicitante" value="#{proyectosMB.escuelaDeptoSelectedSol.idEscuelaDepto}" disabled="#{proyectosMB.mostrarEscuelaSol}" style="width:180px" >
                                            <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                            <c:forEach var="uni" items="#{proyectosMB.escuelaDeptoListSol}">
                                                <f:selectItem itemLabel="#{uni.nombreEscuelaDepto}" itemValue="#{uni.idEscuelaDepto}"/>
                                            </c:forEach>
                                        </p:selectOneMenu>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Tel&eacute;fono Institucional:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputMask id="telefonosolicitante" value="#{proyectosMB.telefonoSolFijo.numeroTelefono}" mask="(503)-9999-9999"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Tel&eacute;fono Celuluar:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputMask id="celularsolicitante" value="#{proyectosMB.telefonoSolCel.numeroTelefono}" mask="(503)-9999-9999"/>
                                    </p:column>
                                </p:panelGrid>
                                <p:column>
                                    <h:outputLabel value="Agregar Coordinador t&eacute;cnico? " />
                                </p:column>
                                <p:column>
                                    <p:selectBooleanButton id="btnExterno" value="#{proyectosMB.tabAsisMostrar}" onLabel="Si" offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width:60px">
                                        <p:ajax update="idTabAsis" listener="#{proyectosMB.mostrarTab()}" />
                                    </p:selectBooleanButton>
                                </p:column>
                            </p:tab>
                            <p:tab title="Datos del Coordinador t&eacute;cnico del proyecto">
                                <h:panelGroup id="idTabAsis" >
                                    <p:panelGrid rendered="#{proyectosMB.tabAsis}">
                                        <p:column>
                                            <p:outputLabel value="Dui:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputMask id="duiasis" mask="99999999-9" value="#{proyectosMB.numDocumentoAsis}"/>
                                            <p:commandButton actionListener="#{proyectosMB.searchByDocAsistente(proyectosMB.numDocumentoAsis)}" id="idBtnSearchInAsis" process="@this,duiasis" update="duiasistente,correoasistente,nombreasistente,apellidoasistente,cargoasistente,facultadasistente,unidadasis,telefonoasistente,celularasistente" icon="ui-icon-search" value="Buscar"/>
                                        </p:column>
                                    </p:panelGrid>
                                    <p:separator rendered="#{proyectosMB.tabAsis}"/>
                                    <p:panelGrid columns="4" rendered="#{proyectosMB.tabAsis}">
                                        <p:column>
                                            <p:outputLabel value="Nombre:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="nombreasistente" value="#{proyectosMB.personaAsistente.nombrePersona}" required="false"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Apellido:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="apellidoasistente" value="#{proyectosMB.personaAsistente.apellidoPersona}" required="false"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Dui:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputMask id="duiasistente" mask="99999999-9" value="#{proyectosMB.personaAsistente.duiPersona}" />
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Correo Electr&oacute;nico:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="correoasistente" value="#{proyectosMB.personaAsistente.emailPersona}"/>                                       
                                        </p:column> 
                                        <p:column>
                                            <p:outputLabel value="Cargo:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="cargoasistente" value="#{proyectosMB.personaAsistente.cargoPersona}"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Facultad/Unidad:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="facultadasistente" value="#{proyectosMB.facultadSelectedPojoAsis}"  style="width:180px" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <c:forEach var="facul" items="#{proyectosMB.facultadesUnidadesList}">
                                                    <f:selectItem itemLabel="#{facul.label}" itemValue="#{facul.value}"/>
                                                </c:forEach>
                                                <p:ajax event="change" listener="#{proyectosMB.mostrarCampoAsis()}" update="unidadasis" process="@this" partialSubmit="true"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Escuela/Departamento"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="unidadasis" value="#{proyectosMB.escuelaDeptoSelectedAsis.idEscuelaDepto}" disabled="#{proyectosMB.mostrarEscuelaAsis}" style="width:180px" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <c:forEach var="uni" items="#{proyectosMB.escuelaDeptoListAsis}">
                                                    <f:selectItem itemLabel="#{uni.nombreEscuelaDepto}" itemValue="#{uni.idEscuelaDepto}"/>
                                                </c:forEach>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Tel&eacute;fono Institucional:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputMask id="telefonoasistente" value="#{proyectosMB.telefonoAsisFijo.numeroTelefono}" mask="(503)-9999-9999"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel value="Tel&eacute;fono Celuluar:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputMask id="celularasistente" value="#{proyectosMB.telefonoAsisCel.numeroTelefono}" mask="(503)-9999-9999"/>
                                        </p:column>
                                    </p:panelGrid>
                                </h:panelGroup>
                            </p:tab>
                            <p:tab title="Datos del Coordinador Externo">
                                <p:panelGrid>
                                    <p:column>
                                        <p:outputLabel value="Documento de Identificaci&oacute;n:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="pasaporteext" value="#{proyectosMB.numDocumentoRefExt}"/>
                                        <p:commandButton actionListener="#{proyectosMB.searchByDocReferenteExterno(proyectosMB.numDocumentoRefExt)}" id="idBtnSearchInExt" process="@this,pasaporteext" update="pasaporteexterna,correoexterna,nombreexterna,apellidoexterna,cargoexterna,unidadasis,telefonoexterna,celularexterno" icon="ui-icon-search" value="Buscar"/>
                                    </p:column>
                                </p:panelGrid>
                                <p:separator/>
                                <p:panelGrid columns="4">
                                    <p:column>
                                        <p:outputLabel value="Nombre:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="nombreexterna" value="#{proyectosMB.personaExterna.nombrePersona}" required="true"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Apellido:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="apellidoexterna" value="#{proyectosMB.personaExterna.apellidoPersona}" required="true"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Documento de Identificaci&oacute;n:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="pasaporteexterna" value="#{proyectosMB.personaExterna.pasaporte}" required="true"/>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Correo Electronico:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="correoexterna" value="#{proyectosMB.personaExterna.emailPersona}"/>                                       
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Cargo:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="cargoexterna" value="#{proyectosMB.personaExterna.cargoPersona}"/>
                                    </p:column>
                                    <p:column >
                                        <p:outputLabel value="Entidad/Instituci&oacute;n"/>
                                    </p:column>
                                    <p:column>
                                        <p:selectOneMenu id="unidadext" value="#{proyectosMB.organismoSelectedRefExt.idOrganismo}"  style="width:180px" required="true">
                                            <f:selectItem itemLabel="--Seleccione--" itemValue="" />
                                            <c:forEach var="org" items="#{proyectosMB.organismoList}">
                                                <f:selectItem itemLabel="#{org.nombreOrganismo}" itemValue="#{org.idOrganismo}"/>
                                            </c:forEach>
                                        </p:selectOneMenu>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Tel&eacute;fono Institucional:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="telefonoexterna" value="#{proyectosMB.telefonoRefextFijo.numeroTelefono}" />
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Tel&eacute;fono Celuluar:"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="celularexterno" value="#{proyectosMB.telefonoRefextCel.numeroTelefono}"/>
                                    </p:column>
                                </p:panelGrid>
                            </p:tab>
                        </p:accordionPanel>                                                                         
                    </p:panel>
                    <p:commandButton styleClass="boton" value="Regresar"  id="btnRegresar" title="Regresar" actionListener="#{proyectosMB.regresar()}" process="@this"/>
                    <p:commandButton styleClass="boton" actionListener="#{proyectosMB.guardarProyecto()}" process="formAdmin" update="formAdmin" value="guardar" id="btnguardarProyecto" title="Guardar Proyecto"/>
                </center>
            </h:form>
        </ui:define>
    </ui:composition>
</html>
