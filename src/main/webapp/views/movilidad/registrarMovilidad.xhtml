<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:poue="http://primefaces.org/ui/extensions">



    <body>

        <ui:composition template="/WEB-INF/templates/layout.xhtml">

            <ui:define name="content">
                <ui:include src="../CategoriaMovilidad/create.xhtml"/>
                <ui:include src="../Pais/createPaisOrigen.xhtml"/>
                <ui:include src="../OrganismoCooperante/createInstitucionMovilidad.xhtml"/>
                <ui:include src="../OrganismoCooperante/createInstitucionMovilidadDestino.xhtml"/>
                <ui:include src="../TipoCambio/Create.xhtml"/>
                <ui:include src="../EtapaMovilidad/create.xhtml"/>
                <ui:include src="../ProgramaMovilidad/create.xhtml"/>
                
                <script type="text/javascript">
                    $.mask.definitions['9'] = '';
                    $.mask.definitions['#'] = '[0-9]';
                </script>
                
                <h1 class="title ui-widget-header ui-corner-all" align="center"><h:outputText value="#{registrarMovilidadMB.tituloRegistroEdicion}" escape="false"/></h1>
                <center>
                    <p:panel style="width: 80%">
                        <h:form id="formAdmin">

                            <!--<p:growl id="growlMovilidad" showDetail="true" sticky="false"/>-->
                            <p:tab>
                                <p:column>
                                    <p:row>
                                        <p:outputLabel for="tipoMovilidad" value="Tipo de movilidad"/>
                                    </p:row>
                                    <p:row>
                                        <p:selectOneMenu id="tipoMovilidad" value="#{registrarMovilidadMB.movilidad.idTipoMovilidad}" style="width: 180px" converter="#{tipoMovilidadConverter}"  required="true" disabled="#{registrarMovilidadMB.isHabilidado}">
                                            <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                            <f:selectItems value="#{registrarMovilidadMB.listTipoMovilidad}" var="tipoMov" itemLabel="#{tipoMov.nombreTipoMovilidad}" itemValue="#{tipoMov}"/>
                                            <p:ajax listener="#{registrarMovilidadMB.onchangeTipoMovilidadList()}" update="formAdmin"/>
                                        </p:selectOneMenu>
                                    </p:row>
                                </p:column>
                            </p:tab>

                            <p:accordionPanel multiple="true" activeIndex="0,1,2,3" id="acordion">
                                <p:tab title="Informaci&oacute;n acad&eacute;mica">
                                    <p:panelGrid columns="4">
                                        <p:column>
                                            <p:outputLabel for="nombreMovilidad" value="Programa de movilidad"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="nombreMovilidad" value="#{registrarMovilidadMB.movilidad.idProgramaMovilidad}" style="width: 180px"  required="true" 
                                                             converter="#{programaMovilidadConverter}">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{programaMovilidadMB.listarProgramasMovilidad()}" var="nombMovilidad" itemLabel="#{nombMovilidad.nombreProgramaMovilidad}" itemValue="#{nombMovilidad}"/>
                                                <!--<p:ajax listener="#{registrarMovilidadMB.onchangeProgramaMovilidadList()}" update="acordion:descripcionMovilidad"/>-->
                                                <p:ajax event="change"  listener="#{registrarMovilidadMB.addNewProgramaMovilidadIfIsNecesary()}" process="@this"  update="formAdmin:acordion:descripcionMovilidad"/>
                                                
                                            </p:selectOneMenu>


                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="descripcionMovilidad" value="Descripci&oacute;n"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputTextarea id="descripcionMovilidad" value="#{registrarMovilidadMB.movilidad.idProgramaMovilidad.descripcion}" style="width:180px" readonly="true"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="categoriaMovilidad" value="Categor&iacute;a movilidad"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="categoriaMovilidad" value="#{registrarMovilidadMB.movilidad.idCategoria}" converter="#{categoriaMovilidadConverter}" style="width: 180px" required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{categoriaMovilidadMB.listarCategoriasMovilidad()}" var="categMovilidad" itemLabel="#{categMovilidad.nombreCategoria}" itemValue="#{categMovilidad}"/>
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.addNewCategoriaMovilidadIfIsNecesary()}" process="@this" update="formAdmin:acordion:categoriaMovilidad"/>
                                            </p:selectOneMenu>
                                        </p:column>

                                    </p:panelGrid>
                                </p:tab>

                                <!--Buscador personas en movilidad-->

                                <p:tab title="Datos docente en movilidad">
                                    <!--Docente Saliente -->
                                    <h:panelGroup id="grup1" rendered="#{registrarMovilidadMB.mostrarBuscadorSaliente}">
                                        <p:panelGrid id="grid">
                                            <p:column>
                                                <p:outputLabel for="tipoBusquedaSal" value="Criterio de B&uacute;squeda:" />
                                            </p:column>
                                            <p:column>                                        
                                                <p:selectOneMenu id="tipoBusquedaSal" value="#{registrarMovilidadMB.tipoBusquedaSaliente}"  style="width:125px">  
                                                    <p:ajax  listener="#{registrarMovilidadMB.habilitarAutoSaliente}" update="grup1,groupPersonaMovilidad,grupDocente"  process="tipoBusquedaSal" />
                                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" />                                                                           
                                                    <f:selectItem itemLabel="Nombres/Apellidos" itemValue="nombre" />                                                                           
                                                    <f:selectItem itemLabel="E-mail" itemValue="email" />
                                                    <f:selectItem itemLabel="Documento" itemValue="doc" />  
                                                </p:selectOneMenu>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel  value="B&uacute;squeda" />     
                                            </p:column>
                                            <p:column> 
                                                <p:autoComplete id="searchDui" minQueryLength="10" size="10" rendered="#{registrarMovilidadMB.flagSearchDuiSaliente}"  value="#{registrarMovilidadMB.personaMovAux}" completeMethod="#{registrarMovilidadMB.methodSearchSaliente}"
                                                                var="name" itemLabel="#{name.duiPersona}" itemValue="#{name}" disabled="#{registrarMovilidadMB.disableAutoSaliente}" converter="#{personaConverter}"
                                                                forceSelection="true">                                            
                                                    <p:column>
                                                        <h:outputText value="#{name.duiPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaSaliente()}" process="@this" update="groupPersonaMovilidad,grupDocente"/>
                                                </p:autoComplete>
                                                <p:watermark for="searchDui" value="DUI"/> 

                                                <p:autoComplete id="idNombreInterno" value="#{registrarMovilidadMB.personaMovAux}" rendered="#{registrarMovilidadMB.flagSearchNombreSaliente}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchSaliente}" disabled="#{registrarMovilidadMB.disableAutoSaliente}"
                                                                var="theme" itemLabel="#{theme.nombrePersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.nombrePersona} #{theme.apellidoPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaSaliente()}" process="@this" update="groupPersonaMovilidad,grupDocente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idNombreInterno" value="Nombre"/> 
                                                <p:autoComplete id="idEmailInterno" value="#{registrarMovilidadMB.personaMovAux}" rendered="#{registrarMovilidadMB.flagSearchEmailSaliente}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchSaliente}" disabled="#{registrarMovilidadMB.disableAutoSaliente}"
                                                                var="theme" itemLabel="#{theme.emailPersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.emailPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaSaliente()}" process="@this" update="groupPersonaMovilidad,grupDocente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idEmailInterno" value="E-mail"/> 
                                            </p:column>
                                        </p:panelGrid>
                                    </h:panelGroup>

                                    <!--Docente Entrante-->
                                    <h:panelGroup id="grup2"  rendered="#{registrarMovilidadMB.mostrarBuscadorEntrante}">
                                        <p:panelGrid id="grid2">
                                            <p:column>
                                                <p:outputLabel for="tipoBusquedaEnt" value="Criterio de B&uacute;squeda:" />
                                            </p:column>
                                            <p:column>                                        
                                                <p:selectOneMenu id="tipoBusquedaEnt" value="#{registrarMovilidadMB.tipoBusquedaEntrante}"  style="width:125px">  
                                                    <p:ajax  listener="#{registrarMovilidadMB.habilitarAutoEntrante}" update="grup2,groupPersonaMovilidad,grupDocente"  process="tipoBusquedaEnt" />
                                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" />                                                                           
                                                    <f:selectItem itemLabel="Nombres/Apellidos" itemValue="nombre" />                                                                           
                                                    <f:selectItem itemLabel="E-mail" itemValue="email" />
                                                </p:selectOneMenu>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel  value="B&uacute;squeda" />     
                                            </p:column>
                                            <p:column> 

                                                <p:autoComplete id="idNombreEntrante" value="#{registrarMovilidadMB.personaMovAux}" rendered="#{registrarMovilidadMB.flagSearchNombreEntrante}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchEntrante}" disabled="#{registrarMovilidadMB.disableAutoEntrante}"
                                                                var="theme" itemLabel="#{theme.nombrePersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.nombrePersona} #{theme.apellidoPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaEntrante()}" process="@this" update="groupPersonaMovilidad,grupDocente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idNombreEntrante" value="Nombre"/> 
                                                <p:autoComplete id="idEmailEntrante" value="#{registrarMovilidadMB.personaMovAux}" rendered="#{registrarMovilidadMB.flagSearchEmailEntrante}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchEntrante}" disabled="#{registrarMovilidadMB.disableAutoEntrante}"
                                                                var="theme" itemLabel="#{theme.emailPersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.emailPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaEntrante()}" process="@this" update="groupPersonaMovilidad,grupDocente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idEmailEntrante" value="E-mail"/> 
                                            </p:column>
                                        </p:panelGrid>
                                    </h:panelGroup>
                                    <!--Panel Group botones Docente en movilidad-->
                                    <h:panelGroup id="grupDocente">
                                        <p:commandButton value="Nuevo" icon="ui-icon-plus" actionListener="#{registrarMovilidadMB.agregarNuevoDocente()}" process="@this" update="groupPersonaMovilidad" rendered="#{registrarMovilidadMB.mostrarBotonNuevoDocente}"/>
                                        <p:commandButton value="Editar" icon="ui-icon-pencil" actionListener="#{registrarMovilidadMB.habilitarActualizarDocente()}" process="@this" update="groupPersonaMovilidad" rendered="#{registrarMovilidadMB.mostrarBotonEditarDocente}"/>
                                    </h:panelGroup>




                                    <p:separator/>
                                    <!--INGRESO DE DATOS DE DOCENTES-->
                                    <h:panelGroup id="groupPersonaMovilidad">
                                        <p:panelGrid columns="4"  id="panelPersonaEnMovilidad">
                                            <p:column>
                                                <p:outputLabel for="nombrePersona" value="Nombres"/>
                                            </p:column>
                                            <p:column>
                                                <p:inputText id="nombrePersona" label="nombrePersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.nombrePersona}" validatorMessage="Este campo solo admite letras" required="true"  disabled="#{registrarMovilidadMB.activarDocente}"/>

                                            </p:column>
                                            <p:column>
                                                <p:outputLabel for="apellidoPersona" value="Apellidos"/>
                                            </p:column>
                                            <p:column>
                                                <p:inputText id="apellidoPersona" label="apellidoPersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.apellidoPersona}" validatorMessage="Este campo solo admite letras" required="true"  disabled="#{registrarMovilidadMB.activarDocente}"/>

                                            </p:column> 
                                            <p:column rendered="#{registrarMovilidadMB.mostrarSaliente}">
                                                <p:outputLabel for="duiPersona" value="DUI"/>
                                            </p:column>
                                            <p:column rendered="#{registrarMovilidadMB.mostrarSaliente}">
                                                <p:inputMask id="duiPersona" mask="########-#" value="#{registrarMovilidadMB.personaMovilidadGenerico.duiPersona}" disabled="#{registrarMovilidadMB.activarDocente}"/>
                                            </p:column>
                                         <!--   <p:column rendered="#{registrarMovilidadMB.mostrarSaliente}" >
                                                <p:outputLabel for="nitPersona" value="NIT"/>
                                            </p:column>
                                            <p:column rendered="#{registrarMovilidadMB.mostrarSaliente}">
                                                <p:inputMask id="nitPersona" mask="99999999-9" value="#{registrarMovilidadMB.personaMovilidadGenerico.nitPersona}"/>
                                            </p:column> -->
                                            <p:column rendered="#{registrarMovilidadMB.mostrarEntrante}">
                                                <p:outputLabel for="pasaportePersona" value="Pasaporte"/>
                                            </p:column>
                                            <p:column rendered="#{registrarMovilidadMB.mostrarEntrante}">
                                                <p:inputText id="pasaportePersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.pasaporte}" disabled="#{registrarMovilidadMB.activarDocente}"/>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel for="cargoPersona" value="Cargo"/>
                                            </p:column>    
                                            <p:column>
                                                <p:inputText id="cargoPersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.cargoPersona}" required="true" disabled="#{registrarMovilidadMB.activarDocente}"/>
                                            </p:column>

                                            <p:column rendered="#{registrarMovilidadMB.mostrarEntrante}">
                                                <p:outputLabel for="InstitucionPersona" value="Instituci&oacute;n"/>
                                            </p:column>
                                            <p:column rendered="#{registrarMovilidadMB.mostrarEntrante}">
                                                <p:selectOneMenu id="InstitucionPersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.idOrganismo}" converter="#{institucionDocenteMovilidadConverter}" style="width: 180px" disabled="#{registrarMovilidadMB.activarDocente}" required="#{!registrarMovilidadMB.facultadDocenteRequerido}">
                                                    <f:selectItem itemLabel="--Seleccione--" itemValue="#{registrarMovilidadMB.institucionPersonaMovilidadSelected}" noSelectionOption="true"/>
                                                    <!--<f:selectItems value="#{registrarMovilidadMB.listOrganismoPersonaMovilidad}" var="institucionPersona" itemLabel="#{institucionPersona.nombreOrganismo}" itemValue="#{institucionPersona}"/>-->
                                                    <f:selectItems value="#{organismoCooperanteMB.listaOrganismos()}" var="institucionPersona" itemLabel="#{institucionPersona.nombreOrganismo}" itemValue="#{institucionPersona}"/>
                                                    <p:ajax listener="#{registrarMovilidadMB.onchangeListInstitucionPersonaMovilidad()}"  update="facultadPersona,telPersona,celPersona"/>
                                                </p:selectOneMenu>
                                            </p:column> 
                                            <p:column>
                                                <p:outputLabel for="facultadPersona" value="Facultad/Unidad"/>  
                                            </p:column>
                                            <p:column>
                                                <p:selectOneMenu id="facultadPersona" value="#{registrarMovilidadMB.facultadPersonaMovilidad}" style="width: 180px" required="#{registrarMovilidadMB.facultadDocenteRequerido}" disabled="#{registrarMovilidadMB.activarDocente}">
                                                    <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                    <f:selectItems value="#{registrarMovilidadMB.listFacultadesUnidadesPersonaMovilidad}" var="facultadPersona" itemLabel="#{facultadPersona.label}" itemValue="#{facultadPersona.value}"/>
                                                    <p:ajax listener="#{registrarMovilidadMB.mostrarEscuelaDocenteMovilidad()}" update="escuelaDepartamentoPersona" process="@this" partialSubmit="true"/>
                                                </p:selectOneMenu>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel for="escuelaDepartamentoPersona" value="Escuela/Departamento"/>   
                                            </p:column>   
                                            <p:column>
                                                <p:selectOneMenu id="escuelaDepartamentoPersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.idEscuelaDepto}" converter="#{EscuelaDepartamentoDocenteConverter}" style="width: 180px" disabled="#{registrarMovilidadMB.mostrarEscuelaDocente}" required="#{registrarMovilidadMB.escuelaDocenteRequerido}">
                                                    <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                    <f:selectItems value="#{registrarMovilidadMB.listEscuelaDepartamentoPersonaMovilidad}" var="escDptoPersona" itemLabel="#{escDptoPersona.nombreEscuelaDepto}" itemValue="#{escDptoPersona}"/>
                                                </p:selectOneMenu>
                                            </p:column> 
                                            <p:column>
                                                <p:outputLabel for="emailPersona" value="Correo Electr&oacute;nico"/>
                                            </p:column>
                                            <p:column>
                                                <p:inputText id="emailPersona" label="emailPersona" value="#{registrarMovilidadMB.personaMovilidadGenerico.emailPersona}"  disabled="#{registrarMovilidadMB.activarDocente}">
                                                    <f:validator validatorId="com.sisrni.validator.emailValidator"/>
                                                </p:inputText>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel for="telPersona" value="Tel&eacute;fono"/>
                                            </p:column>
                                            <p:column>
                                                <p:inputMask id="telPersona" label="telPersona" mask="#{registrarMovilidadMB.mascaraTelefonoMovilidad}"  value="#{registrarMovilidadMB.telFijoPersonaMovilidad.numeroTelefono}" disabled="#{registrarMovilidadMB.activarDocente}"/>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel for="celPersona" value="Tel&eacute;fono movil"/>
                                            </p:column>
                                            <p:column>
                                                <p:inputMask id="celPersona" label="celPersona" mask="#{registrarMovilidadMB.mascaraTelefonoMovilidad}"  value="#{registrarMovilidadMB.telCelPersonaMovilidad.numeroTelefono}" disabled="#{registrarMovilidadMB.activarDocente}"/>
                                            </p:column>  
                                            <!--   <p:column>
                                                   <p:outputLabel for="faxPersona" value="Fax"/>
                                               </p:column>
                                               <p:column>
                                                   <p:inputMask id="faxPersona" label="faxPersona" mask="#{registrarMovilidadMB.mascaraTelefonoMovilidad}"  value="#{registrarMovilidadMB.faxPersonaMovilidad.numeroTelefono}"/> <br/>
                                               </p:column> -->

                                        </p:panelGrid>
                                    </h:panelGroup>

                                </p:tab>
                                <p:tab title="Detalle de Movilidad">
                                    <p:panelGrid columns="4">
                                        <p:column>
                                            <p:outputLabel for="paisOrigen" value="Pa&iacute;s origen"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="paisOrigen" value="#{registrarMovilidadMB.movilidad.idPaisOrigen}" style="width: 180px"  required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{paisMB.listaPaises()}" var="paisOrig" itemLabel="#{paisOrig.nombrePais}" itemValue="#{paisOrig.idPais}"/>
                                               <!--<p:ajax listener="#{registrarMovilidadMB.onchangeListPaisOrigen()}"  update="institucionOrigen"/>-->
                                                <!--<p:ajax event="change" listener="#{registrarMovilidadMB.addNewPaisIfIsNecesary()}" process="@this" update="formRegistrarMovilidad:acordion:paisOrigen"/>-->
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.changePaisOrigen()}" process="@this"  update="institucionOrigen"/>
                                            </p:selectOneMenu>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="institucionOrigen" value="Instituci&oacute;n origen"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="institucionOrigen" value="#{registrarMovilidadMB.movilidad.idUniversidadOrigen}" style="width: 180px"  required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{registrarMovilidadMB.listOrganismosOrigen}" var="institucionOrig" itemLabel="#{institucionOrig.nombreOrganismo}" itemValue="#{institucionOrig.idOrganismo}"/>
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.addNewInstitucionOrigenIfIsNecesary()}" process="@this" update="formAdmin:acordion:institucionOrigen"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="paisDestino" value="Pa&iacute;s destino"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="paisDestino" value="#{registrarMovilidadMB.movilidad.idPaisDestino}" style="width: 180px" required="true" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{paisMB.listaPaises()}" var="paisDest" itemLabel="#{paisDest.nombrePais}" itemValue="#{paisDest.idPais}"/>
                                                <!--<p:ajax listener="#{registrarMovilidadMB.onchangeListPaisDestino()}"  update="institucionDestino"/>-->
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.changePaisDestino()}" process="@this" update="institucionDestino"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="institucionDestino" value="Instituci&oacute;n destino"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="institucionDestino" value="#{registrarMovilidadMB.movilidad.idUniversidadDestino}" style="width: 180px" required="true" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{registrarMovilidadMB.listOrganismosDestino}" var="institucionDest" itemLabel="#{institucionDest.nombreOrganismo}" itemValue="#{institucionDest.idOrganismo}"/>
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.addNewInstitucionDestinoIfIsNecesary()}" process="@this" update="formAdmin:acordion:institucionDestino"/>
                                            </p:selectOneMenu>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="desdeMovilidad" value="Fecha de inicio"/> 
                                        </p:column>
                                        <p:column>
                                            <p:calendar id="desdeMovilidad" value="#{registrarMovilidadMB.movilidad.fechaInicio}" pattern="dd/MM/yyyy"  style=" width: 100px" navigator="true" yearRange="c-50:c+10" required="true">
                                                <p:ajax event="dateSelect" update="hastaMovilidad" />
                                            </p:calendar>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="hastaMovilidad" value="Fecha de finalizaci&oacute;n"/> 
                                        </p:column>
                                        <p:column>
                                            <p:calendar id="hastaMovilidad" value="#{registrarMovilidadMB.movilidad.fechaFin}" pattern="dd/MM/yyyy"  style=" width: 100px" navigator="true" yearRange="c-50:c+10">
                                                <f:attribute name="desdeMovilidad" value="#{registrarMovilidadMB.fechaInicioSelected}"/>
                                                <f:validator validatorId="fechaMayorValidator"/>
                                            </p:calendar>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="tipomoneda" value="Tipo de moneda"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="tipomoneda" value="#{registrarMovilidadMB.tipoCambioSelected.idTipoCambio}" style="width: 180px" required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{tipoCambioMB.listaTipoCambio()}" var="tipoCambio" itemLabel="#{tipoCambio.nombreDivisa}" itemValue="#{tipoCambio.idTipoCambio}"/>
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.addNewtipoCambioIfIsNecesary()}" process="@this" update="formAdmin:acordion:tipomoneda"/>
                                            </p:selectOneMenu>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="viaticos" value="Monto de vi&aacute;ticos"/>
                                        </p:column>
                                        <p:column>
                                            <poue:inputNumber id="viaticos" label="viaticos" value="#{registrarMovilidadMB.movilidad.viaticos}" />
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="pagoCurso" value="Pago de curso"/>
                                        </p:column>
                                        <p:column>
                                            <poue:inputNumber id="pagoCurso" label="pagoCurso" value="#{registrarMovilidadMB.movilidad.pagoDeCurso}" />
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="boletoAereo" value="Boleto a&eacute;reo"/> 
                                        </p:column>
                                        <p:column>
                                            <poue:inputNumber id="boletoAereo" label="boletoAereo" value="#{registrarMovilidadMB.movilidad.voletoAereo}"/>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="consultoria" value="Consultoria"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="consultoria" value="#{registrarMovilidadMB.consultoria}" style="width: 180px">
                                                <f:selectItem itemLabel="SI" itemValue= "true"/>
                                                <f:selectItem itemLabel="NO" itemValue= "false"/> 
                                                <p:ajax listener="#{registrarMovilidadMB.onchangeConsultoria()}" process="@this" update="costoConsultoria"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="costoConsultoria" value="Costos de consultoria"/>
                                        </p:column>
                                        <p:column>
                                            <poue:inputNumber id="costoConsultoria" value="#{registrarMovilidadMB.movilidad.costoConsultoria}" disabled="#{registrarMovilidadMB.disableConsultoria}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel for="etapa" value="Etapa"/> 
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="etapa" value="#{registrarMovilidadMB.movilidad.idEtapaMovilidad}" style="width: 180px" required="true" converter="#{etapaMovilidadConverter}">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{etapaMovilidadMB.listarEtapasMovilidad()}" var="etapaMov" itemLabel="#{etapaMov.nombreEtapa}" itemValue="#{etapaMov}"/>
                                                <p:ajax event="change" listener="#{registrarMovilidadMB.addNewEtapaMovilidadIfIsNecesary()}" process="@this" update="formAdmin:acordion:etapa"/>
                                            </p:selectOneMenu>                                       
                                        </p:column> 

                                        <p:column>
                                            <p:outputLabel for="entregaInforme" value="Entrega de informe"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="entregaInforme" value="#{registrarMovilidadMB.movilidad.entregaDeInforme}" style="width: 180px" >
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItem itemLabel="SI" itemValue= "true"/>
                                                <f:selectItem itemLabel="NO" itemValue= "false"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:outputLabel for="fechaEntregaMined" value="Fecha de entrega de informe"/> 
                                        </p:column>
                                        <p:column>
                                            <p:calendar id="fechaEntregaMined" pattern="dd/MM/yyyy"  style=" width: 100px" navigator="true" yearRange="c-50:c+10" value="#{registrarMovilidadMB.movilidad.fechaEntregaMined}"/>
                                        </p:column>
                                        
                                        <p:column>
                                            <p:outputLabel for="facultadBeneficiada" value="Facultades/Unidades beneficiadas"/>  
                                        </p:column>
                                        <p:column>
                                            <p:selectCheckboxMenu id="facultadBeneficiada" value="#{registrarMovilidadMB.listFacultadesUnidadesBeneficiadasSelected}"  label="Facultades Beneficiadas" panelStyle="width: 250px" style="width: 180px" filter="true" filterMatchMode="startsWith" required="true">
                                                <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                <f:selectItems value="#{registrarMovilidadMB.listFacultadUnidad}" var="facultadBenef" itemLabel="#{facultadBenef.label}" itemValue="#{facultadBenef.value}"/>
                                            </p:selectCheckboxMenu>
                                        </p:column>   

                                        <p:column>
                                            <p:outputLabel for="otroBeneficiado" value="Otro beneficiado"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="otroBeneficiado" label="otroBeneficiado" value="#{registrarMovilidadMB.movilidad.otrosBeneficiados}"/>
                                        </p:column>

                                    </p:panelGrid>
                                </p:tab>


                                <!--Buscador de referente de la facultad -->    
                                <p:tab title="Datos Referente de la facultad" id="panelPersonaReferente">
                                    <h:panelGroup id="grup3">
                                        <p:panelGrid id="gridRef">
                                            <p:column>
                                                <p:outputLabel for="tipoBusquedaRef" value="Criterio de B&uacute;squeda:" />
                                            </p:column>
                                            <p:column>                                        
                                                <p:selectOneMenu id="tipoBusquedaRef" value="#{registrarMovilidadMB.tipoBusquedaReferente}"  style="width:125px" disabled="#{registrarMovilidadMB.habilitarBuscadorReferente}">  
                                                    <p:ajax  listener="#{registrarMovilidadMB.habilitarAutoReferente}" update="grup3,GroupReferente,grupReferente"  process="tipoBusquedaRef" />
                                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" />                                                                           
                                                    <f:selectItem itemLabel="Nombres" itemValue="nombre" />                                                                           
                                                    <f:selectItem itemLabel="E-mail" itemValue="email" />
                                                    <f:selectItem itemLabel="Documento" itemValue="doc"/>  
                                                </p:selectOneMenu>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel  value="B&uacute;squeda" />     
                                            </p:column>
                                            <p:column> 
                                                <p:autoComplete id="searchDuiRef" minQueryLength="10" size="10" rendered="#{registrarMovilidadMB.flagSearchDuiReferente}"  value="#{registrarMovilidadMB.personaReftAux}" completeMethod="#{registrarMovilidadMB.methodSearchReferente}"
                                                                var="name" itemLabel="#{name.duiPersona}" itemValue="#{name}" disabled="#{registrarMovilidadMB.disableAutoReferente}" converter="#{personaConverter}"
                                                                forceSelection="true">                                            
                                                    <p:column>
                                                        <h:outputText value="#{name.duiPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaReferente()}" process="@this" update="GroupReferente,grupReferente"/>
                                                </p:autoComplete>
                                                <p:watermark for="searchDuiRef" value="DUI"/> 

                                                <p:autoComplete id="idNombreReferente" value="#{registrarMovilidadMB.personaReftAux}" rendered="#{registrarMovilidadMB.flagSearchNombreReferente}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchReferente}" disabled="#{registrarMovilidadMB.disableAutoReferente}"
                                                                var="theme" itemLabel="#{theme.nombrePersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.nombrePersona} #{theme.apellidoPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaReferente()}" process="@this" update="GroupReferente,grupReferente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idNombreReferente" value="Nombre"/> 

                                                <p:autoComplete id="idEmailReferente" value="#{registrarMovilidadMB.personaReftAux}" rendered="#{registrarMovilidadMB.flagSearchEmailReferente}"
                                                                completeMethod="#{registrarMovilidadMB.methodSearchReferente}" disabled="#{registrarMovilidadMB.disableAutoReferente}"
                                                                var="theme" itemLabel="#{theme.emailPersona}" itemValue="#{theme}" converter="#{personaConverter}" 
                                                                forceSelection="true">                                           
                                                    <p:column>
                                                        <h:outputText value="#{theme.emailPersona}" />
                                                    </p:column>
                                                    <p:ajax event="itemSelect" listener="#{registrarMovilidadMB.cargarNombrePersonaReferente()}" process="@this" update="GroupReferente,grupReferente"/>
                                                </p:autoComplete>
                                                <p:watermark for="idEmailInterno" value="E-mail"/> 
                                            </p:column>

                                        </p:panelGrid>
                                    </h:panelGroup>
                                    <h:panelGroup id="grupReferente">
                                        <p:commandButton value="Nuevo" icon="ui-icon-plus" actionListener="#{registrarMovilidadMB.agregarNuevoReferente()}" process="@this" update="GroupReferente" rendered="#{registrarMovilidadMB.mostrarBotonNuevoReferente}"/>
                                        <p:commandButton value="Editar" icon="ui-icon-pencil" actionListener="#{registrarMovilidadMB.habilitarActualizacionReferente()}" process="@this" update="GroupReferente,grup3" rendered="#{registrarMovilidadMB.mostrarBotonEditarReferente}"/>
                                    </h:panelGroup>

                                   
                                    <p:separator/>
                                    <h:panelGroup id="GroupReferente">
                                        <p:panelGrid  id="panelReferente">
                                            
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel for="nombrePersonaFacultad" value="Nombres"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputText id="nombrePersonaFacultad" label="nombrePersonaFacultad" value="#{registrarMovilidadMB.personaFacultadGenerico.nombrePersona}" validatorMessage="Este campo solo admite letras" required="true"  disabled="#{registrarMovilidadMB.activarReferente}"/>

                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel for="apellidoPersonaFacultad" value="Apellidos"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputText id="apellidoPersonaFacultad" label="apellidoPersonaFacultad" value="#{registrarMovilidadMB.personaFacultadGenerico.apellidoPersona}" validatorMessage="Este campo solo admite letras" required="true"  disabled="#{registrarMovilidadMB.activarReferente}"/>

                                                </p:column> 
                                            </p:row> 
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel for="duiPersonaFacultad" value="DUI"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputMask id="duiPersonaFacultad" mask="########-#" value="#{registrarMovilidadMB.personaFacultadGenerico.duiPersona}" disabled="#{registrarMovilidadMB.activarReferente}"/>
                                                </p:column>
                                                <!--  <p:column>
                                                          <p:outputLabel for="nitPersonaFacultad" value="NIT"/>
                                                      </p:column>
                                                      <p:column>
                                                          <p:inputMask id="nitPersonaFacultad" mask="99999999-9" value="#{registrarMovilidadMB.personaFacultadGenerico.nitPersona}"/>
                                                      </p:column>  -->
                                                <p:column>
                                                    <p:outputLabel for="cargoPersonaFacultad" value="Cargo"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputText id="cargoPersonaFacultad" value="#{registrarMovilidadMB.personaFacultadGenerico.cargoPersona}" required="true" disabled="#{registrarMovilidadMB.activarReferente}"/>
                                                </p:column>
                                            </p:row>
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel for="facultadBeneficiadaPersona" value="Facultad/unidad"/> 
                                                </p:column>
                                                <p:column>
                                                    <p:selectOneMenu id="facultadBeneficiadaPersona" value="#{registrarMovilidadMB.facultadDeReferente}" style="width: 180px" required="true" disabled="#{registrarMovilidadMB.activarReferente}">
                                                        <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                        <f:selectItems value="#{registrarMovilidadMB.listFacultadUnidadReferenteFactBnf}" var="facultadBenefPersona" itemLabel="#{facultadBenefPersona.label}" itemValue="#{facultadBenefPersona.value}"/>
                                                        <p:ajax listener="#{registrarMovilidadMB.mostrarEscuelaReferenteFact()}" update="escuelaDepartamentoReferenteFactBnf" process="@this" partialSubmit="true"/>
                                                    </p:selectOneMenu>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel for="escuelaDepartamentoReferenteFactBnf" value="Escuela/Departamento"/> 
                                                </p:column>   
                                                <p:column>
                                                    <p:selectOneMenu id="escuelaDepartamentoReferenteFactBnf" value="#{registrarMovilidadMB.personaFacultadGenerico.idEscuelaDepto}" style="width: 180px" converter="#{EscuelaDepartamentoDocenteConverter}" disabled="#{registrarMovilidadMB.mostrarEscuelaReferente}" required="#{registrarMovilidadMB.escuelaReferenteRequerido}">
                                                        <f:selectItem itemLabel="--Seleccione--" itemValue="" noSelectionOption="true"/>
                                                        <f:selectItems value="#{registrarMovilidadMB.listEscuelaDepartamentoRefFact}" var="unidadPersona" itemLabel="#{unidadPersona.nombreEscuelaDepto}" itemValue="#{unidadPersona}"/>
                                                    </p:selectOneMenu>
                                                </p:column> 
                                            </p:row>
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel for="emailPersonaFacultad" value="Correo Electr&oacute;nico"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputText id="emailPersonaFacultad" label="emailPersonaFacultad" value="#{registrarMovilidadMB.personaFacultadGenerico.emailPersona}" required="true" disabled="#{registrarMovilidadMB.activarReferente}">
                                                        <f:validator validatorId="com.sisrni.validator.emailValidator"/>
                                                    </p:inputText>
                                                </p:column>
                                                <p:column>
                                                    <p:outputLabel for="telPersonaFacultad" value="Tel&eacute;fono institucional"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputMask id="telPersonaFacultad" label="telPersona" mask="+503 #### ####"  value="#{registrarMovilidadMB.telFijoPersonaFacultad.numeroTelefono}" disabled="#{registrarMovilidadMB.activarReferente}"/>
                                                </p:column>
                                            </p:row>
                                            <p:row>
                                                <p:column>
                                                    <p:outputLabel for="celPersonaFacultad" value="Tel&eacute;fono movil"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputMask id="celPersonaFacultad" label="celPersonaFacultad" mask="+503 #### ####"  value="#{registrarMovilidadMB.telCelPersonaFacultad.numeroTelefono}" disabled="#{registrarMovilidadMB.activarReferente}"/>
                                                </p:column>
                                            </p:row>
                                            <p:row>
                                                <p:column>
                                                    <p:commandButton value="Desvincular" icon="ui-icon-person" actionListener="#{registrarMovilidadMB.confirmarDesvincularReferente()}" process="@this" rendered="#{registrarMovilidadMB.mostrarBotonDesvincular}"/>
                                                </p:column>
                                            </p:row>    
                                            <!--    <p:column>
                                                    <p:outputLabel for="faxPersonaFacultad" value="Fax"/>
                                                </p:column>
                                                <p:column>
                                                    <p:inputMask id="faxPersonaFacultad" label="faxPersonaFacultad" mask="(503)-9999-9999"  value="#{registrarMovilidadMB.faxPersonaFacultad.numeroTelefono}"/> <br/>
                                                </p:column> -->
                                        </p:panelGrid>
                                    </h:panelGroup>
                                </p:tab>
                            </p:accordionPanel>
                            <p:panel>
                                <h:panelGrid columns="4">
                                    <p:column>
                                        <h:panelGroup/>
                                    </p:column>
                                    <p:column>
                                        <p:commandButton styleClass="boton" actionListener="#{registrarMovilidadMB.regresar()}"  process="@this" icon="#{registrarMovilidadMB.iconRegresarCancelar}"  value="#{registrarMovilidadMB.txtBotonRegresar}"  id="btnRegresar" title="Regresar" />
                                    </p:column>
                                    <p:column>
                                        <p:commandButton styleClass="boton" actionListener="#{registrarMovilidadMB.preGuardadoMovilidad()}" process="formAdmin" update="formAdmin"  icon="#{registrarMovilidadMB.iconGuardarActualizar}" value="#{registrarMovilidadMB.txtBotonGuardar}"  id="btnModificar"  title="Guardar Movilidad" />                                 
                                    </p:column>
                                    <p:column>
                                        <h:panelGroup/>
                                    </p:column>
                                </h:panelGrid>
                            </p:panel>

                        </h:form>
                    </p:panel>
                </center>


                <!--Dialog persona en movilidad-->
                <!--   <p:confirmDialog widgetVar="dlgExistePersonaMov" id="dialogopermov" header="Persona ya existe en el sistema"  
                                    global="true" showEffect="fade" hideEffect="fade">
                       <f:facet name="message" >
                           <h:outputText value="#{registrarMovilidadMB.msgPersonaMovExiste}" escape="false"/>
                       </f:facet>
   
                       <h:form id="dialogPersonaMovExiste">
                           <p:panelGrid columns="2">
                               <h:outputLabel value="Nombre: "/>
                               <h:outputText value="#{registrarMovilidadMB.personaMovAux.nombrePersona}"/>
                               <h:outputLabel value="Apellidos: "/>
                               <h:outputText value="#{registrarMovilidadMB.personaMovAux.apellidoPersona}"/>
                               <h:outputLabel value="Cargo: "/>
                               <h:outputText value="#{registrarMovilidadMB.personaMovAux.cargoPersona}"/>
                               <h:outputLabel value="Institucion: "/>
                               <h:outputText value="#{registrarMovilidadMB.personaMovAux.idOrganismo.nombreOrganismo}"/>
                               <h:outputLabel value="Email: "/>
                               <h:outputText value="#{registrarMovilidadMB.personaMovAux.emailPersona}"/>
                           </p:panelGrid>
                       </h:form>     
                       <p:commandButton value="Aceptar" type="submit" action="#{registrarMovilidadMB.sobreEscribirPersonaEnmovilidad()}" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                       <p:commandButton value="Cancelar" type="submit" action="#{registrarMovilidadMB.closeDlgPersonaMov}" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                   </p:confirmDialog> -->
   

                <p:confirmDialog widgetVar="dlgEdicionDocente" id="dialogDocenteUpdate" header="Modificar Persona" message="Ya existe el docente que desea ingresar, Est&aacute; seguro que desea reemplazar los datos?"
                                 global="true" showEffect="fade" hideEffect="fade">

                    <p:commandButton value="Si" type="submit" action="#{registrarMovilidadMB.siModificarDocente()}" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                    <p:commandButton value="No" type="submit" action="#{registrarMovilidadMB.noModificarDocente()}" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />               

                </p:confirmDialog>    

                <p:confirmDialog widgetVar="dlgEdicionReferente" id="dialogReferenteUpdate" header="Modificar Persona" message="Ya existe el referente que desea ingresar, Est&aacute; seguro que desea reemplazar los datos?"
                                 global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Si" type="submit" action="#{registrarMovilidadMB.siModificarReferente()}" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                    <p:commandButton value="No" type="submit" action="#{registrarMovilidadMB.noModificarReferente()}" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />                 
                </p:confirmDialog>
                
                <p:confirmDialog widgetVar="dlgConfirmarDesvincularReferente" id="dialogDesvincularReferente" header="Desvicular Referente" message="Est&aacute; seguro que desea desvincular al referente de la facultad?"
                    global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Si" type="submit" action="#{registrarMovilidadMB.desvincularReferente()}" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                    <p:commandButton value="No" type="submit" styleClass="ui-confirmdialog-no" icon="ui-icon-close" onclick="PF('dlgConfirmarDesvincularReferente').hide();"/>
                </p:confirmDialog>
            </ui:define>

        </ui:composition>

    </body>
</html>
