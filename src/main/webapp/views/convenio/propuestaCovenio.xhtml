<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition  template="/WEB-INF/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions" 
    >
                    
    <ui:define name="content">
            <h:form id="formAdmin">
                <center> 
                <p:panel style="width: 75%">  
                    <p:accordionPanel multiple="true" activeIndex="0,1,2,3">
                           <p:tab title="Datos del Solicitante">
                               <h:panelGrid columns="2" >
                                   <p:column>  
                                     <p:outputLabel for="idSolicinateNombre" value="Nombre Solicitante" />
                                   </p:column>                                         
                                   <p:column>                                                                                                                                                                                             
                                       <p:inputText id="idSolicinateNombre"  required="true" label="Nombre" value="#{propuestaConvenioMB.solicitante.nombrePersona}"/>
                                       <p:message for="idSolicinateNombre" />                                       
                                   </p:column>

                                   <p:column>  
                                     <p:outputLabel for="idFacultad" value="Facultad" />
                                   </p:column>                                         
                                  <p:column> 
                                      <p:inputText id="idFacultad"  required="true" label="Facultad" value="#{propuestaConvenioMB.solicitante.idUnidad.idFacultad.nombreFacultad}"/>
                                       <p:message for="idFacultad" />
                                   </p:column>

                                   <p:column>  
                                     <p:outputLabel for="idUnidad" value="Unidad" />
                                      </p:column>                                         
                                    <p:column> 
                                        <p:inputText id="idUnidad"  required="true" label="unidad" value="#{propuestaConvenioMB.solicitante.idUnidad.nombre}"/>
                                       <p:message for="idUnidad" />
                                   </p:column>

                                   <p:column>
                                     <p:outputLabel for="idCargo" value="Cargo Solicitante" />
                                      </p:column>                                         
                                    <p:column> 
                                        <p:inputText id="idCargo"  required="true" label="cargo" value="#{propuestaConvenioMB.solicitante.cargoPersona}"/>
                                       <p:message for="idCargo" />
                                   </p:column>    
                               </h:panelGrid>
                           </p:tab>
                           <p:tab title="Datos Referente Interno">
                               <h:panelGrid columns="2">
                                    <p:column>  
                                    <p:outputLabel for="idSolicinateNombreInterno" value="Nombre Solicitante" />
                                   </p:column>                                         
                                   <p:column>                                                                                
                                         <p:autoComplete id="idSolicinateNombreInterno"  dropdown="true" minQueryLength="3"  value="#{propuestaConvenioMB.referenteInterno}" completeMethod="#{propuestaConvenioMB.completeSolicitanteInterno}"
                                                            var="interno" itemLabel="#{interno.nombrePersona}" itemValue="#{interno}" converter="#{personaConverter}" forceSelection="true" >                                                                                                                                                                                                                                         
                                                <p:column>
                                                    <h:outputText value="#{interno.nombrePersona} #{interno.apellidoPersona}" />
                                                </p:column>
                                         </p:autoComplete>
                                         <p:message for="idSolicinateNombreInterno" />
                                         <p:commandButton actionListener="#{propuestaConvenioMB.searchByNameInterno}" id="idBtnSearchIn" process="@this,idSolicinateNombreInterno" update="idFacultadInterno,idUnidadInterno,formAdmin" icon="ui-icon-disk" title="Icon Only"/>
                                        <p:message for="idBtnSearchIn" /> 
                                   </p:column> 
                                   
                                   <p:column>  
                                       <p:outputLabel for="idDocumentoInterno" value="N&deg; Documento" />
                                   </p:column>                                         
                                   <p:column>                                         
                                       <p:inputText id="idDocumentoInterno"  required="true" label="c" value="#{propuestaConvenioMB.numDocumentoInterno}"/>
                                       <p:message for="idDocumentoInterno" />
                                   </p:column>  
                                   <p:column>  
                                     <p:outputLabel for="email" value="Correo Electr&oacute;nico" />
                                    </p:column>                                         
                                   <p:column>  
                                       <p:inputText id="email" required="true" value="#{propuestaConvenioMB.referenteInterno.emailPersona}">
                                           <f:validator validatorId="com.sisrni.validator.emailValidator" />
                                      </p:inputText>
                                      <p:message for="email" display="tooltip" />  
                                      <p:commandButton actionListener="#{propuestaConvenioMB.searchByDocEmailInterno}" process="@this idDocumentoInterno email" id="idBtnSearchInByEmail" update="growl" icon="ui-icon-search" title="Buscar referente interno" />
                                   </p:column> 
                                   
                                   <p:column>  
                                     <p:outputLabel for="idFacultadInterno" value="Facultad" />
                                   </p:column>                                         
                                   <p:column>    
                                       <p:inputText id="idFacultadInterno"  required="true" readonly="true" label="Facultad" value="#{propuestaConvenioMB.referenteInterno.idUnidad.idFacultad.nombreFacultad}"/>
                                       <p:message for="idFacultadInterno" />
                                   </p:column>  
                                   <p:column>      
                                     <p:outputLabel for="idUnidadInterno" value="Unidad" />
                                    </p:column>                                         
                                   <p:column>  
                                       <p:inputText id="idUnidadInterno"  required="true" readonly="true" label="unidad" value="#{propuestaConvenioMB.referenteInterno.idUnidad.nombre}"/>
                                       <p:message for="idUnidadInterno" />
                                   </p:column>         
                                   <p:column>  
                                     <p:outputLabel for="idCargoInterno" value="Cargo Solicitante" />
                                   </p:column>                                         
                                   <p:column>  
                                       <p:inputText id="idCargoInterno"  required="true" label="cargo" readonly="true" value="#{propuestaConvenioMB.referenteInterno.cargoPersona}" />
                                       <p:message for="idCargoInterno" />
                                   </p:column>
                                      
                                   <p:column>  
                                      <p:outputLabel for="idTelefonoInterno" value="Tel&eacute;fono " />  
                                    </p:column>                                         
                                   <p:column>  
                                       <p:inputText id="idTelefonoInterno" readonly="true" value="#{propuestaConvenioMB.telFijoInterno.numeroTelefono}"/>
                                         
                                      <p:message for="idTelefonoInterno" />
                                   </p:column>  
                                   <p:column>      
                                      <p:outputLabel for="idFaxInterno" value="Fax" /> 
                                    </p:column>                                         
                                   <p:column>  
                                       <p:inputText id="idFaxInterno" readonly="true" value="#{propuestaConvenioMB.faxInterno.numeroTelefono}"/>                                          
                                      <p:message for="idFaxInterno" />
                                   </p:column>  
                               </h:panelGrid>
                           </p:tab>
                           <p:tab title="Datos Referente Externo">
                               <h:panelGrid  columns="2">
                                   
                                    <p:column>  
                                       <p:outputLabel for="idNombreExterno" value="Nombre" />
                                   </p:column>  
                                                          
                                   <p:column>                 
                                       
   
                                       <p:autoComplete id="idNombreExterno" dropdown="true" minQueryLength="3"  value="#{propuestaConvenioMB.referenteExterno}" completeMethod="#{propuestaConvenioMB.completeSolicitanteExterno}"
                                                            var="externo" itemLabel="#{externo.nombrePersona}" itemValue="#{externo}" converter="#{personaConverter}" forceSelection="true">                                                                                           
                                                 <f:selectItem itemLabel="Nombre Referente Interno" itemValue="null" itemDisabled="true" />
                                                <p:column>
                                                    <h:outputText value="#{externo.nombrePersona} #{externo.apellidoPersona}" />
                                                </p:column>
                                         </p:autoComplete>
                                         <p:message for="idNombreExterno" />
                                         <p:commandButton actionListener="#{propuestaConvenioMB.searchByNameExterno}" id="idBtnSearchEx" process="@this,idNombreExterno" update="formAdmin" icon="ui-icon-disk" title="Icon Only"/>
                                   </p:column> 
                                   
                                   
                                    <p:column>  
                                       <p:outputLabel for="idDocumentoExterno" value="N&deg; Documento" />
                                   </p:column>                                         
                                   <p:column>                                         
                                       <p:inputText id="idDocumentoExterno"  required="true" label="c" value="#{propuestaConvenioMB.numDocumentoExterno}"/>
                                       <p:message for="idDocumentoExterno" />
                                   </p:column>  
                                   <p:column>  
                                     <p:outputLabel for="emailExterno" value="Correo Electr&oacute;nico" />
                                   </p:column>      
                                   <p:column> 
                                       <p:inputText id="emailExterno" required="true" value="#{propuestaConvenioMB.referenteExterno.emailPersona}">
                                           <f:validator validatorId="com.sisrni.validator.emailValidator" />
                                      </p:inputText>
                                       <p:message for="emailExterno" display="tooltip" />  
                                       <p:commandButton actionListener="#{propuestaConvenioMB.searchByDocEmailExterno}" process="@this idDocumentoExterno emailExterno" id="idBtnSearchExByEmail" update="growl" icon="ui-icon-search" title="Buscar referente interno" />
                                    </p:column>                                         
                                  
                                   <p:column>  
                                        <p:outputLabel for="idCargoExterno" value="Cargo" />
                                   </p:column>      
                                   <p:column> 
                                       <p:inputText id="idCargoExterno" readonly="true" label="cargo" value="#{propuestaConvenioMB.referenteExterno.cargoPersona}"/>
                                       <p:message for="idCargoExterno" />   
                                   </p:column>  
                                   <p:column>      
                                        <p:outputLabel for="idEntidadInstitucion" value="Entidad o Instituci&oacute;n" />
                                   </p:column>      
                                   <p:column> 
                                       <p:inputText id="idEntidadInstitucion"  readonly="true" label="Entidad o institucion" value="#{propuestaConvenioMB.referenteExterno.idOrganismo.nombreOrganismo}"/>
                                       <p:message for="idEntidadInstitucion" />    
                                   </p:column>      
                                    <p:column>  
                                      <p:outputLabel for="idTelefonoExterno" value="Tel&eacute;fono " />   
                                    </p:column>      
                                   <p:column>   
                                       <p:inputMask id="idTelefonoExterno" readonly="true" mask="(999) 999-9999" value="#{propuestaConvenioMB.telFijoExterno.numeroTelefono}" required="true"/>
                                      <p:message for="idTelefonoExterno" />
                                   </p:column>  
                                   <p:column>      
                                      <p:outputLabel for="idFaxExterno" value="Fax" />  
                                    </p:column>      
                                   <p:column>   
                                       <p:inputMask id="idFaxExterno" readonly="true" mask="(999) 999-9999" value="#{propuestaConvenioMB.faxExterno.numeroTelefono}" required="true"/>
                                      <p:message for="idFaxExterno" />
                                   </p:column>

                               </h:panelGrid>
                           </p:tab>
                           <p:tab title="Datos de Propuesta">
                               <h:panelGrid columns="2" >
                                   
                                   <p:column style="padding:5px">  
                                        <p:outputLabel for="idTipoPropuesta" value="Tipo de Propuesta" />                                         
                                   </p:column>  
                                  
                                    <p:column>  
                                        <p:outputLabel for="idConvenioPropuesta" value="Convenio" />                                            
                                   </p:column>
                                   
                                    <p:column style="padding:20px">
                                        <p:inputText id="idTipoPropuesta"  required="true" label="Tipo Propuesta"/>
                                        <p:message for="idTipoPropuesta" />                                        
                                   </p:column>
                                   
                                   <p:column>
                                        <p:inputText id="idConvenioPropuesta"  required="true" label="convenio"/>
                                        <p:message for="idConvenioPropuesta" />   
                                   </p:column>
                                   
                                   
                                    <p:column>  
                                        <p:outputLabel for="idNombrePropuesta" value="Nombre de Propuesta" />                                          
                                   </p:column>
                                   
                                    <p:column>  
                                        <p:outputLabel for="idDescripcionPropuesta" value="Descripci&oacute;n" />                                        
                                   </p:column> 
                                   
                                   <p:column>
                                       <p:inputText id="idNombrePropuesta"  required="true" label="nombre propuesta"/>
                                       <p:message for="idNombrePropuesta" />
                                   </p:column>
                                   
                                   <p:column>
                                        <p:inputText id="idDescripcionPropuesta"  required="true" label="descripcion"/>
                                       <p:message for="idDescripcionPropuesta" /> 
                                   </p:column>
                                   
                               </h:panelGrid>
                           </p:tab>
                   </p:accordionPanel>
                </p:panel>   
                </center>    
            </h:form>   
        
        <script type="text/javascript">
            /**
             * Faces Validator
             */
            PrimeFaces.validator['custom.emailValidator'] = {

                pattern: /\S+@\S+/,

                validate: function(element, value) {
                    //use element.data() to access validation metadata, in this case there is none.
                    if(!this.pattern.test(value)) {
                        throw {
                            summary: 'Validation Error',
                            detail: value + ' is not a valid email.'
                        }
                    }
                }
            };    
        </script>
        
    </ui:define>
    
    
</ui:composition>
